---
description: Helpers para crear personajes de prueba en tests
globs: 
alwaysApply: true
---

# Helpers para Tests de Personaje

## Ubicación

Los helpers para crear personajes de prueba están en `core/tests/character/`:

- `getDefaultCharacterData()` — Datos base mínimos
- `buildCharacter()` — Builder pattern con fluent API

## Uso básico

### Datos mínimos

```typescript
import { getDefaultCharacterData } from "core/tests/character/defaultCharacter";

const character = getDefaultCharacterData();
```

### Builder pattern (recomendado)

```typescript
import { buildCharacter } from "core/tests";

// Solo datos base
const character = buildCharacter().build();

// Con configuración
const fighter = buildCharacter()
  .withName("Test Fighter")
  .withClassLevels(fighterClass, 5)
  .withBaseAbilityScores({
    strength: 16,
    dexterity: 14,
    constitution: 14,
    intelligence: 10,
    wisdom: 12,
    charisma: 8,
  })
  .build();

// Obtener CharacterSheet calculado directamente
const sheet = buildCharacter()
  .withClassLevels(rogueClass, 3)
  .buildCharacterSheet();
```

## Métodos del Builder

| Método | Descripción |
|--------|-------------|
| `.withName(name)` | Nombre del personaje |
| `.withClassLevels(class, levels, avgRoll?)` | Añadir niveles de clase |
| `.withBaseAbilityScore(ability, score)` | Una característica |
| `.withBaseAbilityScores(record)` | Todas las características |
| `.withRace(race)` | Asignar raza |
| `.withFeats(feats)` | Añadir dotes |
| `.withBuff(buff)` | Añadir un buff |
| `.withBuffs(buffs)` | Añadir varios buffs |
| `.withItemEquipped(item)` | Añadir item equipado |
| `.withSkillRanks(skill, ranks)` | Asignar rangos |
| `.withSpecialFeatures(features)` | Rasgos especiales |
| `.build()` | Obtener `CharacterBaseData` |
| `.buildCharacterSheet()` | Obtener `CharacterSheet` calculado |

## NO crear helpers duplicados

❌ **No hacer esto** en cada test:

```typescript
function createEmptyCharacter(): CharacterBaseData {
  return {
    name: 'Test Character',
    temporaryHp: 0,
    // ... 20 líneas más
  };
}
```

✅ **Usar los helpers existentes**:

```typescript
import { buildCharacter } from "core/tests";

const character = buildCharacter().build();
```
